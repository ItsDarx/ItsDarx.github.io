<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-image: url('https://www.xtrafondos.com/wallpapers/gta-vi-grand-theft-auto-6-12062.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            font-family: Arial, sans-serif;
        }

        .contenido {
            padding: 20px;
            color: #fff;
        }

        label {
            display: block;
        }

        input {
            padding-right: 100px;
        }
    </style>
</head>

<body>
    <div class="contenido">
        <h3 style="text-align: center;">Formulario Venta de VideoJuegos</h3>
        <center>
            <form action="">Porfavor llene el siguiente formulario:
                <br>
                <br>
                <label for="nombre"><b>Nombre: </b></label>
                <input type="text" id="nombre">
                <br>
                <br>
                <label for="correo"><b>Correo Electrónico:</b> </label>
                <input type="email" id="correo">
                <br>
                <br>
                <label for="videojuego"><b>Videojuego:</b> </label>
                <select id="videojuego">
                     <option value="mario">Super Mario Bros</option>
                     <option value="zelda">The Legend of Zelda</option>
                     <option value="pokemon">Pokémon Red/Blue</option>
                     <option value="minecraft">Minecraft</option>
                     <option value="gtav">Grand Theft Auto V</option>
                     <option value="fortnite">Fortnite</option>
                     <option value="pubg">PlayerUnknown's Battlegrounds</option>
                     <option value="fifa">FIFA 21</option>
                     <option value="overwatch">Overwatch</option>
                     <option value="wow">World of Warcraft</option>
                     <option value="halo">Halo: Combat Evolved</option>
                     <option value="witcher">The Witcher 3: Wild Hunt</option>
                     <option value="dark-souls">Dark Souls</option>
                     <option value="skyrim">The Elder Scrolls V: Skyrim</option>
                     <option value="league-of-legends">League of Legends</option>
                     <option value="dota">Dota 2</option>
                     <option value="counter-strike">Counter-Strike: Global Offensive</option>
                     <option value="god-of-war">God of War</option>
                     <option value="assassins-creed">Assassin's Creed Odyssey</option>
                     <option value="red-dead-redemption">Red Dead Redemption 2</option>
                     <option value="mgs">Metal Gear Solid V: The Phantom Pain</option>
                     <option value="fallout">Fallout 4</option>
                     <option value="resident-evil">Resident Evil 7: Biohazard</option>
                     <option value="bioshock">BioShock Infinite</option>
              </select>
                <br>
                <br>
                <label for="plataforma"><b>Plataforma: </b></label>
                <select id="plataforma" name="">
                    <option value="PlayStation 4">PlayStation 4</option>
                    <option value="PlayStation 5">PlayStation 5</option>
                    <option value="Xbox Series X/S">Xbox Series X/S</option>
                    <option value="Nintendo Switch">Nintendo Switch</option>
                </select>
                <br>
                <br>
                <label for="cantidad"><b>Cantidad:</b> </label>
                <input type="number" name="" id="cantidad">
                <br>
                <br>
                <button type="button" onclick="crearRegistro()">Enviar</button>
            </form>
        </center>
        <br>
        <br>

        <div class="container">
            <table class="table table-hover">
                <h3 style="text-align: center;">Datos de tus Videojuegos</h3>
                <thead>
                    <tr>
                        <th>NOMBRE</th>
                        <th>CORREO ELECTRONICO</th>
                        <th>VIDEOJUEGO</th>
                        <th>PLATAFORMA</th>
                        <th>CANTIDAD</th>
                        <th>ACCIONES</th>
                    </tr>
                </thead>
                <tbody id="tablaDatos">
                </tbody>
            </table>
        </div>

        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
            import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

            const firebaseConfig = {
                apiKey: "AIzaSyBLaYAnYQvpqo21wDUNKqIzpVfTmg_cnP8",
                authDomain: "conexion-8f0ae.firebaseapp.com",
                databaseURL: "https://conexion-8f0ae-default-rtdb.firebaseio.com",
                projectId: "conexion-8f0ae",
                storageBucket: "conexion-8f0ae.appspot.com",
                 messagingSenderId: "465864700800",
                appId: "1:465864700800:web:53d50490ad67dfa2a24765"
                                
                                };
    
            

            const app = initializeApp(firebaseConfig);
            const database = getDatabase(app);

            function mostrarDatosEnTabla() {
                const tableBody = document.getElementById("tablaDatos");

                onValue(ref(database, 'Christian'), (snapshot) => {
                    tableBody.innerHTML = '';
                    snapshot.forEach((childSnapshot) => {
                        const data = childSnapshot.val();
                        const row = `<tr>
                        <td>${data.name}</td>
                        <td>${data.mail}</td>
                        <td>${data.videogame}</td>
                        <td>${data.platform}</td>
                        <td>${data.cant}</td>
                        <td>
                          <button onclick="editarRegistro('${childSnapshot.key}')">Editar</button>
                          <button onclick="eliminarRegistro('${childSnapshot.key}')">Eliminar</button>
                        </td>
                    </tr>`;
                        tableBody.innerHTML += row;
                    });
                });
            }

            function limpiarCampos() {
                document.getElementById("nombre").value = "";
                document.getElementById("correo").value = "";
                document.getElementById("videojuego").value = "";
                document.getElementById("plataforma").value = "PlayStation 4";
                document.getElementById("cantidad").value = "";
            }

            window.crearRegistro = function () {
                const nombre = document.getElementById("nombre").value;
                const correo = document.getElementById("correo").value;
                const videojuego = document.getElementById("videojuego").value;
                const plataforma = document.getElementById("plataforma").value;
                const cantidad = document.getElementById("cantidad").value;

                push(
                    ref(database, 'Christian'),
                    {
                        name: nombre,
                        mail: correo,
                        videogame: videojuego,
                        platform: plataforma,
                        cant: cantidad
                    }
                );

                limpiarCampos(); // Limpiar campos después de enviar
                mostrarDatosEnTabla();
            }

            window.eliminarRegistro = function (key) {
                remove(ref(database, 'Christian/' + key));
                mostrarDatosEnTabla();
            }

            window.editarRegistro = function (key) {
                const nombre = document.getElementById("nombre").value;
                const correo = document.getElementById("correo").value;
                const videojuego = document.getElementById("videojuego").value;
                const plataforma = document.getElementById("plataforma").value;
                const cantidad = document.getElementById("cantidad").value;

                update(ref(database, 'Christian/' + key), {
                    name: nombre,
                    mail: correo,
                    videogame: videojuego,
                    platform: plataforma,
                    cant: cantidad
                });

                mostrarDatosEnTabla();
            };

            mostrarDatosEnTabla();
            limpiarCampos();
        </script>
    </div>
</body>

</html>
